<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="485px" preserveAspectRatio="none" style="width:688px;height:485px;" version="1.1" viewBox="0 0 688 485" width="688px" zoomAndPan="magnify"><defs><filter height="300%" id="f1aisc4dimlijd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="94.5" cy="25" fill="#000000" filter="url(#f1aisc4dimlijd)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1aisc4dimlijd)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="31" x="125" y="8"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="11" x="135" y="29.6016">m</text><rect fill="#FEFECE" filter="url(#f1aisc4dimlijd)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="176" y="8"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="37" x="186" y="29.6016">Queue</text><polygon fill="#FEFECE" filter="url(#f1aisc4dimlijd)" points="204.5,83,216.5,95,204.5,107,192.5,95,204.5,83" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1aisc4dimlijd)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="6" y="163"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="67" x="16" y="184.6016">Batch Mode</text><rect fill="#FEFECE" filter="url(#f1aisc4dimlijd)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="91" x="190" y="163"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="200" y="184.6016">Message Set</text><rect fill="#FEFECE" filter="url(#f1aisc4dimlijd)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="100.5" y="253"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="108" x="110.5" y="274.6016">AsyncContext&lt;m&gt;</text><rect fill="#FEFECE" filter="url(#f1aisc4dimlijd)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="198" x="120.5" y="343"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="178" x="130.5" y="364.6016">Acknowledge Async Processing</text><path d="M112,418 L112,473.9316 A0,0 0 0 0 112,473.9316 L327,473.9316 A0,0 0 0 0 327,473.9316 L327,428 L317,418 L223.5,418 L219.5,377.4034 L215.5,418 L112,418 A0,0 0 0 0 112,418 " fill="#FBFB77" filter="url(#f1aisc4dimlijd)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M317,418 L317,428 L327,428 L317,418 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="118" y="435.5684">Each message has an exposed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="137" x="118" y="450.8789">function to mark it as</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="118" y="466.1895">processed.</text><ellipse cx="447.5" cy="270" fill="none" filter="url(#f1aisc4dimlijd)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="448" cy="270.5" fill="#000000" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1aisc4dimlijd)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="120" x="301.5" y="163"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="100" x="311.5" y="184.6016">SyncContext&lt;m&gt;</text><rect fill="#FEFECE" filter="url(#f1aisc4dimlijd)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="190" x="487.5" y="163"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="170" x="497.5" y="184.6016">Acknowledge Sync Processing</text><!--link start to m--><path d="M104.5625,25 C109.6162,25 114.6699,25 119.7236,25 " fill="none" id="start-m" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="124.7773,25,115.7773,21,119.7773,25,115.7773,29,124.7773,25" style="stroke: #666666; stroke-width: 1.0;"/><!--link m to Queue--><path d="M156.25,25 C161.0483,25 165.8466,25 170.6449,25 " fill="none" id="m-Queue" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="175.8516,25,166.8516,21,170.8516,25,166.8516,29,175.8516,25" style="stroke: #666666; stroke-width: 1.0;"/><!--link Queue to #7--><path d="M204.5,42.3034 C204.5,53.1588 204.5,67.0963 204.5,77.9108 " fill="none" id="Queue-#7" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="204.5,82.9417,208.5,73.9417,204.5,77.9417,200.5,73.9417,204.5,82.9417" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="113.0938" y="72.2343">Extract Batch</text><!--link #7 to Batch Mode--><path d="M196.6004,99.332 C176.4676,110.3726 122.2366,140.1122 85.5552,160.2278 " fill="none" id="#7-Batch Mode" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="80.7252,162.8765,90.5398,162.0561,85.1092,160.4723,86.6931,155.0417,80.7252,162.8765" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="20" x="146.5" y="139.6016">Yes</text><!--link Batch Mode to Message Set--><path d="M93.1087,180 C120.5024,180 155.9502,180 184.6243,180 " fill="none" id="Batch Mode-Message Set" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="189.896,180,180.896,176,184.896,180,180.896,184,189.896,180" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="104" y="173.6016">Extract Batch</text><!--link Message Set to AsyncContext<m>--><path d="M189.7266,192.0599 C177.4921,197.5976 165.6855,205.5753 158.5,217 C152.8743,225.9447 153.4559,237.4456 155.8289,247.4468 " fill="none" id="Message Set-AsyncContext&lt;m&gt;" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="157.2097,252.5186,158.7048,242.7839,155.8961,247.6942,150.9858,244.8856,157.2097,252.5186" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="98" x="159.5" y="229.6016">Checkout (Track)</text><!--link AsyncContext<m> to Acknowledge Async Processing--><path d="M175.1046,287.3529 C183.9307,301.7958 196.548,322.4422 206.0774,338.0357 " fill="none" id="AsyncContext&lt;m&gt;-Acknowledge Async Processing" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="208.928,342.7004,207.648,332.9351,206.3207,338.434,200.8218,337.1067,208.928,342.7004" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="196.5" y="319.6016">Process</text><!--link Acknowledge Async Processing to Message Set--><path d="M234.5813,342.9918 C239.1023,337.0402 243.6194,330.0696 246.5,323 C261.7504,285.5726 256.6037,273.3112 259.5,233 C260.0096,225.9072 261.5178,223.8188 259.5,217 C257.9031,211.6037 255.2448,206.2561 252.2662,201.374 " fill="none" id="Acknowledge Async Processing-Message Set" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="249.462,197.0333,250.986,206.7635,252.1752,201.2331,257.7057,202.4223,249.462,197.0333" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="46" x="259.5" y="274.6016">Remove</text><!--link Message Set to end--><path d="M275.8746,197.1402 C323.9977,217.5698 401.872,250.6296 433.4891,264.052 " fill="none" id="Message Set-end" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="438.1547,266.0327,431.4334,258.8338,433.5523,264.0788,428.3072,266.1977,438.1547,266.0327" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="354.5" y="229.6016">Maintain Until Empty</text><!--link #7 to SyncContext<m>--><path d="M212.5015,99.332 C232.9773,110.4177 288.2738,140.3552 325.4336,160.4736 " fill="none" id="#7-SyncContext&lt;m&gt;" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="329.8719,162.8765,323.8618,155.074,325.475,160.496,320.053,162.1091,329.8719,162.8765" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="16" x="292.5" y="139.6016">No</text><!--link SyncContext<m> to Acknowledge Sync Processing--><path d="M421.5973,180 C440.3325,180 461.528,180 482.2395,180 " fill="none" id="SyncContext&lt;m&gt;-Acknowledge Sync Processing" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="487.4929,180,478.4929,176,482.4929,180,478.4929,184,487.4929,180" style="stroke: #666666; stroke-width: 1.0;"/><text fill="#666666" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="432.5" y="173.6016">Process</text><!--link Acknowledge Sync Processing to end--><path d="M556.7898,197.1402 C527.9354,216.3764 482.2843,246.8105 460.2421,261.5053 " fill="none" id="Acknowledge Sync Processing-end" style="stroke: #666666; stroke-width: 1.0;"/><polygon fill="#666666" points="455.9114,264.3924,465.6186,262.7282,460.0716,261.6189,461.181,256.0719,455.9114,264.3924" style="stroke: #666666; stroke-width: 1.0;"/><!--
@startuml





skinparam defaultTextAlignment center

skinparam wrapWidth 200
skinparam maxMessageSize 150

skinparam rectangle {
    StereotypeFontSize 12
    shadowing false
}

skinparam database {
    StereotypeFontSize 12
    shadowing false
}

skinparam Arrow {
    Color #666666
    FontColor #666666
    FontSize 12
}

skinparam rectangle<<boundary>> {
    Shadowing false
    StereotypeFontSize 0
    FontColor #444444
    BorderColor #444444
    BorderStyle dashed
}






















skinparam rectangle<<person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #08427B
    BorderColor #073B6F
}

skinparam rectangle<<external_person>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #686868
    BorderColor #8A8A8A
}

skinparam rectangle<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam rectangle<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}

skinparam database<<system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #1168BD
    BorderColor #3C7FC0
}

skinparam database<<external_system>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #999999
    BorderColor #8A8A8A
}
















skinparam rectangle<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}

skinparam database<<container>> {
    StereotypeFontColor #FFFFFF
    FontColor #FFFFFF
    BackgroundColor #438DD5
    BorderColor #3C7FC0
}








(*) -> "m"
-> "Queue"
if "Extract Batch" then
    - -> [Yes] "Batch Mode"
    -> [Extract Batch] "Message Set"
    - -> [Checkout (Track)] "AsyncContext<m>"
    "AsyncContext<m>" - -> [Process] "Acknowledge Async Processing"
    note bottom
        Each message has an exposed function to mark it as processed.
    end note
    - -> [Remove] "Message Set"
    "Message Set" -> [Maintain Until Empty] (*)
else
    - -> [No] "SyncContext<m>"
    "SyncContext<m>" -> [Process] "Acknowledge Sync Processing"
    - -> (*)
@enduml

PlantUML version 1.2019.03(Sun Mar 10 21:04:44 AEST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 12.0.1+12
Operating System: Mac OS X
OS Version: 10.14.4
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>